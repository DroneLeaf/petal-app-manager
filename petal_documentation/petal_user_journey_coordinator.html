

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Petal User Journey Coordinator &mdash; Petal App Manager 0.2.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=ba7fdd6d" />

  
    <link rel="shortcut icon" href="../_static/cropped-site-icon.png"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=000c92bf"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Petal Flight Log" href="petal_flight_log.html" />
    <link rel="prev" title="Petal Documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Petal App Manager
              <img src="../_static/White logo-vertical.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#what-is-petal-app-manager">What is Petal App Manager?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction.html#key-features">Key Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction.html#architecture">Architecture</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction.html#system-architecture-diagram">System Architecture Diagram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction.html#architecture-components">Architecture Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction.html#data-flow">Data Flow</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction.html#use-cases">Use Cases</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction.html#why-petal-app-manager">Why Petal App Manager?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/dependencies.html">Dependencies Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/dependencies.html#system-requirements">System Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/dependencies.html#python-3-11-installation">Python 3.11 Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/dependencies.html#pdm-installation">PDM Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/dependencies.html#redis-installation-and-configuration">Redis Installation and Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/dependencies.html#redis-development-tools">Redis Development Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/dependencies.html#controller-dashboard">Controller Dashboard</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html">Quick Start Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#development-installation">Development Installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/quickstart.html#using-hear-cli-recommended">Using HEAR-CLI (Recommended)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/quickstart.html#manual-development-setup">Manual Development Setup</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#production-installation">Production Installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/quickstart.html#id1">Using HEAR-CLI (Recommended)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/quickstart.html#custom-version-installation-field-testing">Custom Version Installation (Field Testing)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/quickstart.html#manual-production-installation">Manual Production Installation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#environment-configuration">Environment Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#running-the-application">Running the Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#verifying-the-installation">Verifying the Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#quick-development-workflow">Quick Development Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../how_to_use/index.html">How to Use</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../how_to_use/making_requests.html">Making Requests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/making_requests.html#using-the-postman-collection">Using the Postman Collection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/making_requests.html#using-the-docs-interface">Using the /docs Interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/making_requests.html#accessing-swagger-ui">Accessing Swagger UI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/making_requests.html#interactive-api-testing">Interactive API Testing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/making_requests.html#using-redoc">Using ReDoc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/making_requests.html#example-api-calls">Example API Calls</a></li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/making_requests.html#quick-testing-workflow">Quick Testing Workflow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../how_to_use/service_management.html">The Petal App Manager Service</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/service_management.html#admin-dashboard-interface">Admin Dashboard Interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/service_management.html#accessing-the-admin-dashboard">Accessing the Admin Dashboard</a></li>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/service_management.html#dashboard-features">Dashboard Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/service_management.html#using-the-admin-dashboard">Using the Admin Dashboard</a></li>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/service_management.html#alternative-access-methods">Alternative Access Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/service_management.html#managing-petals-and-proxies-via-api">Managing Petals and Proxies via API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/service_management.html#checking-what-s-running">Checking What’s Running</a></li>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/service_management.html#viewing-all-available-components">Viewing All Available Components</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/service_management.html#petal-control-via-api">Petal Control via API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/service_management.html#enabling-petals">Enabling Petals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/service_management.html#disabling-petals">Disabling Petals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/service_management.html#proxy-control-via-api">Proxy Control via API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/service_management.html#enabling-proxies">Enabling Proxies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/service_management.html#disabling-proxies">Disabling Proxies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/service_management.html#common-use-cases">Common Use Cases</a></li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/service_management.html#restart-management">Restart Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/service_management.html#service-files-and-locations">Service Files and Locations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../how_to_use/configuration.html">Configuration Changes in .env</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/configuration.html#environment-variables-overview">Environment Variables Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/configuration.html#general-configuration">General Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/configuration.html#petal-log-level">PETAL_LOG_LEVEL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/configuration.html#petal-log-to-file">PETAL_LOG_TO_FILE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/configuration.html#petal-log-dir">PETAL_LOG_DIR</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/configuration.html#mavlink-configuration">MAVLink Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/configuration.html#petal-mavlink-endpoint">PETAL_MAVLINK_ENDPOINT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/configuration.html#petal-mavlink-baud">PETAL_MAVLINK_BAUD</a></li>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/configuration.html#other-mavlink-settings">Other MAVLink Settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/configuration.html#cloud-configuration">Cloud Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/configuration.html#redis-configuration">Redis Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/configuration.html#petal-redis-host-and-petal-redis-port">PETAL_REDIS_HOST and PETAL_REDIS_PORT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/configuration.html#petal-redis-unix-socket-path">PETAL_REDIS_UNIX_SOCKET_PATH</a></li>
<li class="toctree-l4"><a class="reference internal" href="../how_to_use/configuration.html#petal-redis-health-message-rate">PETAL_REDIS_HEALTH_MESSAGE_RATE</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/configuration.html#database-configuration">Database Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/configuration.html#data-operations-urls">Data Operations URLs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/configuration.html#mqtt-configuration">MQTT Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/configuration.html#proxy-connection-retry-configuration">Proxy Connection Retry Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/configuration.html#petal-specific-configuration">Petal-Specific Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/configuration.html#applying-configuration-changes">Applying Configuration Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../how_to_use/configuration.html#configuration-examples">Configuration Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../development_contribution/index.html">Development and Contribution Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../development_contribution/adding_petals.html">Adding a New Petal Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/adding_petals.html#what-is-a-petal">What is a Petal?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/adding_petals.html#creating-a-new-petal">Creating a New Petal</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#using-hear-cli-recommended">Using HEAR-CLI (Recommended)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#manual-setup">Manual Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#petal-structure">Petal Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#key-components">Key Components</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/adding_petals.html#mqtt-command-handlers-mqtt-action">MQTT Command Handlers (<code class="docutils literal notranslate"><span class="pre">&#64;mqtt_action</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#handler-signature">Handler Signature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#the-cpu-heavy-parameter">The <code class="docutils literal notranslate"><span class="pre">cpu_heavy</span></code> Parameter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#how-it-works-under-the-hood">How It Works Under the Hood</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#dynamic-factory-handlers">Dynamic / Factory Handlers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#migration-from-legacy-pattern">Migration from Legacy Pattern</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/adding_petals.html#registering-the-petal">Registering the Petal</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#adding-to-proxies-yaml">Adding to proxies.yaml</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#adding-to-pyproject-toml-for-production">Adding to pyproject.toml (for Production)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/adding_petals.html#installing-your-petal">Installing Your Petal</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#development-installation-editable">Development Installation (Editable)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#production-installation-git-tag">Production Installation (Git Tag)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/adding_petals.html#testing-your-petal">Testing Your Petal</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#unit-tests">Unit Tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#integration-testing">Integration Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#debugging">Debugging</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/adding_petals.html#best-practices">Best Practices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#naming-conventions">Naming Conventions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#proxy-management">Proxy Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#error-handling">Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#logging">Logging</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#versioning">Versioning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#documentation">Documentation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/adding_petals.html#common-pitfalls">Common Pitfalls</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#petal-name-must-start-with-petal">Petal Name Must Start with <code class="docutils literal notranslate"><span class="pre">petal-*</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#petal-not-loading">Petal Not Loading</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/adding_petals.html#entry-point-errors">Entry Point Errors</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/adding_petals.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../development_contribution/inter-petal_communications.html">Inter-Petal Communication Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#goal">Goal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#overview">Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#benefits">Benefits</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#implementation-guide">Implementation Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#for-sink-petal-developers-message-receivers">For Sink Petal Developers (Message Receivers)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#for-source-petal-developers-message-senders">For Source Petal Developers (Message Senders)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#best-practices">Best Practices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#data-model-design">Data Model Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#channel-naming-convention">Channel Naming Convention</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#error-handling">Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#versioning">Versioning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#testing">Testing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#example-complete-implementation">Example: Complete Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#sink-petal-petal-leafsdk">Sink Petal (petal-leafsdk)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#source-petal-petal-qgc-mission-adapter">Source Petal (petal-qgc-mission-adapter)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#acceptance-criteria">Acceptance Criteria</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#reference-implementation">Reference Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#migration-path">Migration Path</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#for-existing-petals">For Existing Petals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#deprecation-strategy">Deprecation Strategy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#additional-resources">Additional Resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#common-issues">Common Issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/inter-petal_communications.html#getting-help">Getting Help</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../development_contribution/contribution_guidelines.html">Contribution Guidelines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/contribution_guidelines.html#dependency-architecture">Dependency Architecture</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/contribution_guidelines.html#understanding-the-petal-stack-dependencies">Understanding the Petal Stack Dependencies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/contribution_guidelines.html#version-management-by-repository">Version Management by Repository</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/contribution_guidelines.html#petal-app-manager">Petal App Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/contribution_guidelines.html#individual-petals">Individual Petals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/contribution_guidelines.html#non-petal-packages">Non-Petal Packages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/contribution_guidelines.html#leafsdk">LeafSDK</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/contribution_guidelines.html#mavlink-pymavlink-very-special-case">mavlink/pymavlink (Very Special Case)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/contribution_guidelines.html#version-summary-table">Version Summary Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/contribution_guidelines.html#getting-help">Getting Help</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../development_contribution/using_proxies.html">Using Proxies in Petals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/using_proxies.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/using_proxies.html#available-proxy-types">Available Proxy Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/using_proxies.html#accessing-proxies-in-your-petal">Accessing Proxies in Your Petal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/using_proxies.html#redisproxy">RedisProxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/using_proxies.html#mavlinkexternalproxy">MavlinkExternalProxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/using_proxies.html#clouddbproxy">CloudDBProxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/using_proxies.html#localdbproxy">LocalDBProxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/using_proxies.html#s3bucketproxy">S3BucketProxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/using_proxies.html#mqttproxy">MQTTProxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/using_proxies.html#error-handling-and-best-practices">Error Handling and Best Practices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/using_proxies.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../development_contribution/advanced_debugging.html">Advanced Debugging and Logging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/advanced_debugging.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/advanced_debugging.html#available-logging-tools">Available Logging Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/advanced_debugging.html#per-level-logging-configuration">Per-Level Logging Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/advanced_debugging.html#configuration-methods">Configuration Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/advanced_debugging.html#output-options">Output Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/advanced_debugging.html#common-configuration-scenarios">Common Configuration Scenarios</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/advanced_debugging.html#legacy-format-support">Legacy Format Support</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/advanced_debugging.html#csv-signal-logging-tool">CSV Signal Logging Tool</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/advanced_debugging.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/advanced_debugging.html#advanced-configuration">Advanced Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/advanced_debugging.html#complete-petal-example">Complete Petal Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/advanced_debugging.html#api-reference">API Reference</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/advanced_debugging.html#debugging-best-practices">Debugging Best Practices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/advanced_debugging.html#environment-specific-configuration">Environment-Specific Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/advanced_debugging.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/advanced_debugging.html#error-handling-and-recovery">Error Handling and Recovery</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/advanced_debugging.html#integration-with-admin-dashboard">Integration with Admin Dashboard</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/advanced_debugging.html#testing-and-validation">Testing and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/advanced_debugging.html#file-management">File Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/advanced_debugging.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/advanced_debugging.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../development_contribution/profiling.html">Petal App Manager Profiling Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/profiling.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/profiling.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/profiling.html#quick-start">Quick Start</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#prerequisites">1. Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#install-dependencies">2. Install Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#start-pam">3. Start PAM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#run-profiling-and-or-monitoring">4. Run Profiling and/or Monitoring</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#view-results">5. View Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#command-line-flags">6. Command-Line Flags</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/profiling.html#profiling-scenarios">Profiling Scenarios</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#workflow-for-profiling-different-scenarios">Workflow for Profiling Different Scenarios</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#example-sitl-mission-for-profiling">Example SITL Mission for Profiling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/profiling.html#output-formats-visualizations">Output Formats &amp; Visualizations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#speedscope-json-interactive">Speedscope JSON (Interactive) ⭐</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#monitor-output-cpu-and-memory-usage">Monitor Output: CPU and Memory Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/profiling.html#interpretation-guide">Interpretation Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#what-to-look-for">What to Look For</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#reading-flame-graphs">Reading Flame Graphs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#common-patterns-to-identify">Common Patterns to Identify</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/profiling.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#environment-issues">Environment Issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#profiler-issues">Profiler Issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#visualization-issues">Visualization Issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#performance-issues">Performance Issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#results-interpretation-issues">Results Interpretation Issues</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/profiling.html#quick-reference">Quick Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#command-cheatsheet">Command Cheatsheet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#file-naming-conventions">File Naming Conventions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development_contribution/profiling.html#keyboard-shortcuts-speedscope">Keyboard Shortcuts (Speedscope)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/profiling.html#getting-help">Getting Help</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development_contribution/profiling.html#summary">Summary</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Petal Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Petal User Journey Coordinator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#required-proxies">Required Proxies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#command-categories">Command Categories</a></li>
<li class="toctree-l3"><a class="reference internal" href="#esc-calibration-commands">ESC Calibration Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#esc-calibration">esc_calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#esc-force-run-all">esc_force_run_all</a></li>
<li class="toctree-l4"><a class="reference internal" href="#esc-force-run-single">esc_force_run_single</a></li>
<li class="toctree-l4"><a class="reference internal" href="#esc-calibration-single">esc_calibration_single</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#parameter-configuration-commands">Parameter Configuration Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#geometry">geometry</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gps-module">gps_module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dist-module">dist_module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#oflow-module">oflow_module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gps-spatial-offset">gps_spatial_offset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#distance-spatial-offset">distance_spatial_offset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#optical-flow-spatial-offset">optical_flow_spatial_offset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#esc-update-calibration-limits">esc_update_calibration_limits</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#bulk-parameter-operations">Bulk Parameter Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bulk-set-parameters">bulk_set_parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bulk-get-parameters">bulk_get_parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#real-time-telemetry-streams">Real-Time Telemetry Streams</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#subscribe-rc-value-stream">subscribe_rc_value_stream</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unsubscribe-rc-value-stream">unsubscribe_rc_value_stream</a></li>
<li class="toctree-l4"><a class="reference internal" href="#subscribe-pose-value-stream">subscribe_pose_value_stream</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unsubscribe-pose-value-stream">unsubscribe_pose_value_stream</a></li>
<li class="toctree-l4"><a class="reference internal" href="#subscribe-ks-status-stream">subscribe_ks_status_stream</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unsubscribe-ks-status-stream">unsubscribe_ks_status_stream</a></li>
<li class="toctree-l4"><a class="reference internal" href="#subscribe-mfs-a-status-stream-subscribe-mfs-b-status-stream">subscribe_mfs_a_status_stream / subscribe_mfs_b_status_stream</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unsubscribeall">unsubscribeall</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#trajectory-verification-commands">Trajectory Verification Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#verify-pos-yaw-directions">verify_pos_yaw_directions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#verify-pos-yaw-directions-complete">verify_pos_yaw_directions_complete</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wifi-optitrack-commands">WiFi &amp; OptiTrack Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#connect-to-wifi-and-verify-optitrack">connect_to_wifi_and_verify_optitrack</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-static-ip-address">set_static_ip_address</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#system-commands">System Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#reboot-px4">reboot_px4</a></li>
<li class="toctree-l4"><a class="reference internal" href="#format-sd-card">format_sd_card</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-log-entries">get_log_entries</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#complete-usage-example">Complete Usage Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#error-handling">Error Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mqtt-topics-reference">MQTT Topics Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#commands-received-on-command-edge">Commands (Received on <code class="docutils literal notranslate"><span class="pre">command/edge</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#published-topics-sent-to-command-web">Published Topics (Sent to <code class="docutils literal notranslate"><span class="pre">command/web</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="petal_flight_log.html">Petal Flight Log</a><ul>
<li class="toctree-l3"><a class="reference internal" href="petal_flight_log.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="petal_flight_log.html#required-proxies">Required Proxies</a></li>
<li class="toctree-l3"><a class="reference internal" href="petal_flight_log.html#command-categories">Command Categories</a></li>
<li class="toctree-l3"><a class="reference internal" href="petal_flight_log.html#flight-record-fetch-commands">Flight Record Fetch Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#fetch-flight-records">fetch_flight_records</a></li>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#subscribe-fetch-flight-records">subscribe_fetch_flight_records</a></li>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#unsubscribe-fetch-flight-records">unsubscribe_fetch_flight_records</a></li>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#cancel-fetch-flight-records">cancel_fetch_flight_records</a></li>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#fetch-existing-flight-records">fetch_existing_flight_records</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="petal_flight_log.html#flight-record-sync-commands">Flight Record Sync Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#start-sync-flight-record">start_sync_flight_record</a></li>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#subscribe-sync-job-value-stream">subscribe_sync_job_value_stream</a></li>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#unsubscribe-sync-job-value-stream">unsubscribe_sync_job_value_stream</a></li>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#cancel-sync-job">cancel_sync_job</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="petal_flight_log.html#flight-record-management-commands">Flight Record Management Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#delete-flight-record">delete_flight_record</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="petal_flight_log.html#bulk-delete-flight-records-commands">Bulk Delete Flight Records Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#bulk-delete-flight-records">bulk_delete_flight_records</a></li>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#subscribe-bulk-delete-flight-records">subscribe_bulk_delete_flight_records</a></li>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#unsubscribe-bulk-delete-flight-records">unsubscribe_bulk_delete_flight_records</a></li>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#cancel-bulk-delete-flight-records">cancel_bulk_delete_flight_records</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="petal_flight_log.html#clear-error-logs-commands">Clear Error Logs Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#detect-error-logs">detect_error_logs</a></li>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#clear-error-logs">clear_error_logs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="petal_flight_log.html#clear-all-ulogs-commands">Clear All ULogs Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#clear-all-ulogs">clear_all_ulogs</a></li>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#subscribe-clear-all-ulogs">subscribe_clear_all_ulogs</a></li>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#unsubscribe-clear-all-ulogs">unsubscribe_clear_all_ulogs</a></li>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#cancel-clear-all-ulogs">cancel_clear_all_ulogs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="petal_flight_log.html#job-status-values">Job Status Values</a></li>
<li class="toctree-l3"><a class="reference internal" href="petal_flight_log.html#mqtt-topics-reference">MQTT Topics Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="petal_flight_log.html#data-models">Data Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#flightrecordmatch">FlightRecordMatch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="petal_flight_log.html#error-handling">Error Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="petal_flight_log.html#id1">MQTT Topics Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#commands-received-on-command-edge">Commands (Received on <code class="docutils literal notranslate"><span class="pre">command/edge</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="petal_flight_log.html#published-topics-sent-to-command-web">Published Topics (Sent to <code class="docutils literal notranslate"><span class="pre">command/web</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="petal_flight_log.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-2-2-2026-02-22">Version 0.2.2 (2026-02-22)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-2-1-2026-02-12">Version 0.2.1 (2026-02-12)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-2-0-2026-02-12">Version 0.2.0 (2026-02-12)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-62-2026-02-06">Version 0.1.62 (2026-02-06)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-61-2026-02-03">Version 0.1.61 (2026-02-03)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-60-2026-01-30">Version 0.1.60 (2026-01-30)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-59-2026-01-27">Version 0.1.59 (2026-01-27)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-57-2026-01-18">Version 0.1.57 (2026-01-18)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-56-2026-01-17">Version 0.1.56 (2026-01-17)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-54-2026-01-15">Version 0.1.54 (2026-01-15)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-53-2026-01-15">Version 0.1.53 (2026-01-15)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-52-2026-01-14">Version 0.1.52 (2026-01-14)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-51-2026-01-08">Version 0.1.51 (2026-01-08)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-50-2026-01-05">Version 0.1.50 (2026-01-05)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-49-2025-01-05">Version 0.1.49 (2025-01-05)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-48-2025-12-31">Version 0.1.48 (2025-12-31)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-47-2025-12-31">Version 0.1.47 (2025-12-31)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-46-2025-12-31">Version 0.1.46 (2025-12-31)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-45-2025-11-23">Version 0.1.45 (2025-11-23)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-44-2025-11-07">Version 0.1.44 (2025-11-07)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-43-2025-11-05-hotfix">Version 0.1.43 (2025-11-05) - Hotfix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-42-2025-11-03">Version 0.1.42 (2025-11-03)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-41-2025-11-02">Version 0.1.41 (2025-11-02)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-39-2025-10-23">Version 0.1.39 (2025-10-23)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-38-2025-10-23">Version 0.1.38 (2025-10-23)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-37-2025-10-22">Version 0.1.37 (2025-10-22)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-31-2025-09-25">Version 0.1.31 (2025-09-25)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-29-2025-08-28">Version 0.1.29 (2025-08-28)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-28-2025-08-17">Version 0.1.28 (2025-08-17)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-23-2025-07-31">Version 0.1.23 (2025-07-31)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-18-2025-07-29">Version 0.1.18 (2025-07-29)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-5-2025-07-03-first-stable-release">Version 0.1.5 (2025-07-03) - First Stable Release</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-0-1-0-2025-06-22-initial-release">Version 0.1.0 (2025-06-22) - Initial Release</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/index.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/core_api.html">Core API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core_api.html#module-petal_app_manager.api.admin_ui">Admin UI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.admin_ui.admin_dashboard"><code class="docutils literal notranslate"><span class="pre">admin_dashboard()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.admin_ui.get_logger"><code class="docutils literal notranslate"><span class="pre">get_logger()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core_api.html#module-petal_app_manager.api.health">Health Endpoints</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.health.detailed_health_check"><code class="docutils literal notranslate"><span class="pre">detailed_health_check()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.health.get_logger"><code class="docutils literal notranslate"><span class="pre">get_logger()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.health.health_check"><code class="docutils literal notranslate"><span class="pre">health_check()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.health.organization_health_check"><code class="docutils literal notranslate"><span class="pre">organization_health_check()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core_api.html#module-petal_app_manager.api.config_api">Configuration API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.config_api.AllComponentsResponse"><code class="docutils literal notranslate"><span class="pre">AllComponentsResponse</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.config_api.ConfigResponse"><code class="docutils literal notranslate"><span class="pre">ConfigResponse</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.config_api.PetalControlRequest"><code class="docutils literal notranslate"><span class="pre">PetalControlRequest</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.config_api.PetalInfo"><code class="docutils literal notranslate"><span class="pre">PetalInfo</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.config_api.ProxyInfo"><code class="docutils literal notranslate"><span class="pre">ProxyInfo</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.config_api.control_petals"><code class="docutils literal notranslate"><span class="pre">control_petals()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.config_api.control_proxies"><code class="docutils literal notranslate"><span class="pre">control_proxies()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.config_api.get_logger"><code class="docutils literal notranslate"><span class="pre">get_logger()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.config_api.get_status"><code class="docutils literal notranslate"><span class="pre">get_status()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.config_api.list_all_components"><code class="docutils literal notranslate"><span class="pre">list_all_components()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core_api.html#module-petal_app_manager.api.cloud_api">Cloud API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.cloud_api.GetItemRequest"><code class="docutils literal notranslate"><span class="pre">GetItemRequest</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.cloud_api.ScanTableRequest"><code class="docutils literal notranslate"><span class="pre">ScanTableRequest</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.cloud_api.SetItemRequest"><code class="docutils literal notranslate"><span class="pre">SetItemRequest</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.cloud_api.UpdateItemRequest"><code class="docutils literal notranslate"><span class="pre">UpdateItemRequest</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.cloud_api.delete_item"><code class="docutils literal notranslate"><span class="pre">delete_item()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.cloud_api.get_item"><code class="docutils literal notranslate"><span class="pre">get_item()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.cloud_api.get_logger"><code class="docutils literal notranslate"><span class="pre">get_logger()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.cloud_api.scan_table"><code class="docutils literal notranslate"><span class="pre">scan_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.cloud_api.set_item"><code class="docutils literal notranslate"><span class="pre">set_item()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.cloud_api.update_item"><code class="docutils literal notranslate"><span class="pre">update_item()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core_api.html#module-petal_app_manager.api.bucket_api">Bucket API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.bucket_api.delete_file_test"><code class="docutils literal notranslate"><span class="pre">delete_file_test()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.bucket_api.download_file_test"><code class="docutils literal notranslate"><span class="pre">download_file_test()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.bucket_api.get_info"><code class="docutils literal notranslate"><span class="pre">get_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.bucket_api.get_logger"><code class="docutils literal notranslate"><span class="pre">get_logger()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.bucket_api.list_files_test"><code class="docutils literal notranslate"><span class="pre">list_files_test()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.bucket_api.upload_file_test"><code class="docutils literal notranslate"><span class="pre">upload_file_test()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core_api.html#module-petal_app_manager.api.mavftp_api">MAVLink FTP API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.mavftp_api.ClearFailLogsRequest"><code class="docutils literal notranslate"><span class="pre">ClearFailLogsRequest</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.mavftp_api.clear_fail_logs"><code class="docutils literal notranslate"><span class="pre">clear_fail_logs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.mavftp_api.get_logger"><code class="docutils literal notranslate"><span class="pre">get_logger()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.mavftp_api.list_directory"><code class="docutils literal notranslate"><span class="pre">list_directory()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core_api.html#module-petal_app_manager.api.mqtt_api">MQTT API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.mqtt_api.MQTTResponse"><code class="docutils literal notranslate"><span class="pre">MQTTResponse</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.mqtt_api.PublishMessageRequest"><code class="docutils literal notranslate"><span class="pre">PublishMessageRequest</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.mqtt_api.SubscribePatternRequest"><code class="docutils literal notranslate"><span class="pre">SubscribePatternRequest</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.mqtt_api.SubscribeTopicRequest"><code class="docutils literal notranslate"><span class="pre">SubscribeTopicRequest</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.mqtt_api.UnsubscribeTopicRequest"><code class="docutils literal notranslate"><span class="pre">UnsubscribeTopicRequest</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.mqtt_api.get_logger"><code class="docutils literal notranslate"><span class="pre">get_logger()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.mqtt_api.get_mqtt_status"><code class="docutils literal notranslate"><span class="pre">get_mqtt_status()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.mqtt_api.list_subscriptions"><code class="docutils literal notranslate"><span class="pre">list_subscriptions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.mqtt_api.publish_message"><code class="docutils literal notranslate"><span class="pre">publish_message()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.mqtt_api.subscribe_topic"><code class="docutils literal notranslate"><span class="pre">subscribe_topic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.mqtt_api.unsubscribe_topic"><code class="docutils literal notranslate"><span class="pre">unsubscribe_topic()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core_api.html#module-petal_app_manager.api.proxy_info">Proxy Info</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.proxy_info.get_logger"><code class="docutils literal notranslate"><span class="pre">get_logger()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core_api.html#petal_app_manager.api.proxy_info.list_proxies"><code class="docutils literal notranslate"><span class="pre">list_proxies()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/proxies.html">Proxies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/proxies.html#module-petal_app_manager.proxies.base">Base Proxy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#petal_app_manager.proxies.base.BaseProxy"><code class="docutils literal notranslate"><span class="pre">BaseProxy</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/proxies.html#module-petal_app_manager.proxies.redis">Redis Proxy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#redisproxy">RedisProxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#petal_app_manager.proxies.redis.RedisProxy"><code class="docutils literal notranslate"><span class="pre">RedisProxy</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/proxies.html#module-petal_app_manager.proxies.external">External MAVLink Proxy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#petalappmanager-proxies-external">petalappmanager.proxies.external</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#petal_app_manager.proxies.external.DownloadCancelledException"><code class="docutils literal notranslate"><span class="pre">DownloadCancelledException</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#petal_app_manager.proxies.external.ExternalProxy"><code class="docutils literal notranslate"><span class="pre">ExternalProxy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#petal_app_manager.proxies.external.FTPDeleteError"><code class="docutils literal notranslate"><span class="pre">FTPDeleteError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#petal_app_manager.proxies.external.MavLinkExternalProxy"><code class="docutils literal notranslate"><span class="pre">MavLinkExternalProxy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#petal_app_manager.proxies.external.MavLinkFTPProxy"><code class="docutils literal notranslate"><span class="pre">MavLinkFTPProxy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#petal_app_manager.proxies.external.ULogInfo"><code class="docutils literal notranslate"><span class="pre">ULogInfo</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#petal_app_manager.proxies.external.setup_file_only_logger"><code class="docutils literal notranslate"><span class="pre">setup_file_only_logger()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/proxies.html#module-petal_app_manager.proxies.localdb">Local Database Proxy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#localdbproxy">LocalDBProxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#petal_app_manager.proxies.localdb.LocalDBProxy"><code class="docutils literal notranslate"><span class="pre">LocalDBProxy</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/proxies.html#module-petal_app_manager.proxies.cloud">Cloud Proxy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#clouddbproxy">CloudDBProxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#petal_app_manager.proxies.cloud.CloudDBProxy"><code class="docutils literal notranslate"><span class="pre">CloudDBProxy</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/proxies.html#module-petal_app_manager.proxies.bucket">Bucket Proxy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#petal_app_manager.proxies.bucket.S3BucketProxy"><code class="docutils literal notranslate"><span class="pre">S3BucketProxy</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/proxies.html#module-petal_app_manager.proxies.mqtt">MQTT Proxy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#mqttproxy">MQTTProxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#petal_app_manager.proxies.mqtt.MQTTProxy"><code class="docutils literal notranslate"><span class="pre">MQTTProxy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/proxies.html#petal_app_manager.proxies.mqtt.MessageCallback"><code class="docutils literal notranslate"><span class="pre">MessageCallback</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/plugins.html">Plugins System</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/plugins.html#module-petal_app_manager.plugins.base">Base Petal</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/plugins.html#petal_app_manager.plugins.base.Petal"><code class="docutils literal notranslate"><span class="pre">Petal</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/plugins.html#module-petal_app_manager.plugins.decorators">Decorators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/plugins.html#petal_app_manager.plugins.decorators.http_action"><code class="docutils literal notranslate"><span class="pre">http_action()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/plugins.html#petal_app_manager.plugins.decorators.mqtt_action"><code class="docutils literal notranslate"><span class="pre">mqtt_action()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/plugins.html#petal_app_manager.plugins.decorators.websocket_action"><code class="docutils literal notranslate"><span class="pre">websocket_action()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/plugins.html#module-petal_app_manager.plugins.loader">Loader</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/plugins.html#petal_app_manager.plugins.loader.initialize_petals"><code class="docutils literal notranslate"><span class="pre">initialize_petals()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/plugins.html#petal_app_manager.plugins.loader.load_petals"><code class="docutils literal notranslate"><span class="pre">load_petals()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/plugins.html#petal_app_manager.plugins.loader.startup_petals"><code class="docutils literal notranslate"><span class="pre">startup_petals()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/petals.html">Available Petals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/petals.html#production-petals">Production Petals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/petals.html#petal-flight-log">petal-flight-log</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/petals.html#petal-warehouse">petal-warehouse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/petals.html#petal-leafsdk">petal-leafsdk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/petals.html#petal-user-journey-coordinator">petal-user-journey-coordinator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/petals.html#development-petals">Development Petals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/petals.html#petal-qgc-mission-server">petal-qgc-mission-server</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/index.html#core-modules">Core Modules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../known_issues.html">Known Issues</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../known_issues.html#petal-issues">Petal Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../known_issues.html#petal-name-must-start-with-petal">Petal Name Must Start with <code class="docutils literal notranslate"><span class="pre">petal-*</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../known_issues.html#petal-not-getting-loaded">Petal Not Getting Loaded</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../known_issues.html#python-3-11-issues">Python 3.11 Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../known_issues.html#python-3-11-not-found">Python 3.11 Not Found</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../known_issues.html#pdm-issues">PDM Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../known_issues.html#pdm-installation-fails">PDM Installation Fails</a></li>
<li class="toctree-l3"><a class="reference internal" href="../known_issues.html#pdm-lock-file-issues">PDM Lock File Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../known_issues.html#redis-issues">Redis Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../known_issues.html#redis-connection-errors">Redis Connection Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../known_issues.html#redis-configuration-issues">Redis Configuration Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../known_issues.html#mavlink-issues">MAVLink Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../known_issues.html#mavlink-connection-issues">MAVLink Connection Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../known_issues.html#mavlink-submodule-branch-issues-sitl">MAVLink Submodule Branch Issues (SITL)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../known_issues.html#mqtt-issues">MQTT Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../known_issues.html#mqtt-proxy-fails-on-fresh-installation">MQTT Proxy Fails on Fresh Installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../known_issues.html#port-conflicts">Port Conflicts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../known_issues.html#port-9000-already-in-use">Port 9000 Already in Use</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../known_issues.html#reporting-issues">Reporting Issues</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Petal App Manager</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Petal Documentation</a></li>
      <li class="breadcrumb-item active">Petal User Journey Coordinator</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/petal_documentation/petal_user_journey_coordinator.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="petal-user-journey-coordinator">
<h1>Petal User Journey Coordinator<a class="headerlink" href="#petal-user-journey-coordinator" title="Link to this heading"></a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This documentation is for <strong>petal-user-journey-coordinator v0.1.12</strong></p>
</div>
<p>The <strong>petal-user-journey-coordinator</strong> is a critical petal that provides MQTT-based command handling for drone configuration, calibration, real-time telemetry streaming, and trajectory verification. It serves as the primary interface between web/mobile applications and the drone’s flight controller.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>This petal communicates via MQTT messages on the <code class="docutils literal notranslate"><span class="pre">command/edge</span></code> topic. All commands follow a standardized message format:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;petal-user-journey-coordinator/&lt;command_name&gt;&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;messageId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;unique-message-id&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;waitResponse&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Command-specific payload</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="required-proxies">
<h2>Required Proxies<a class="headerlink" href="#required-proxies" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mqtt</span></code> - For MQTT communication with web clients</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ext_mavlink</span></code> - For MAVLink communication with the flight controller</p></li>
</ul>
</section>
<section id="command-categories">
<h2>Command Categories<a class="headerlink" href="#command-categories" title="Link to this heading"></a></h2>
</section>
<section id="esc-calibration-commands">
<h2>ESC Calibration Commands<a class="headerlink" href="#esc-calibration-commands" title="Link to this heading"></a></h2>
<p>These commands handle Electronic Speed Controller (ESC) calibration and motor testing.</p>
<section id="esc-calibration">
<h3>esc_calibration<a class="headerlink" href="#esc-calibration" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/esc_calibration</span></code></p>
<p>Initiates and controls the ESC calibration process. ESC calibration sets the throttle range that ESCs recognize.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;is_calibration_started&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;safety_timeout_s&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">3.0</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;force_cancel_calibration&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;esc_interface_signal_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PWM&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;ca_rotor_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;throttle&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">is_calibration_started</span></code> (bool): Whether calibration sequence has begun</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">safety_timeout_s</span></code> (float): Safety timeout in seconds before automatic motor shutoff</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">force_cancel_calibration</span></code> (bool): Force stop all motors immediately</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">esc_interface_signal_type</span></code> (str): Signal type - <code class="docutils literal notranslate"><span class="pre">&quot;PWM&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;DShot&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ca_rotor_count</span></code> (int): Number of rotors (typically 4, 6, or 8)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">throttle</span></code> (str|null): Throttle command - <code class="docutils literal notranslate"><span class="pre">&quot;maximum&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;minimum&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">null</span></code></p></li>
</ul>
<p><strong>Example - Full Calibration Sequence:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 1: Configure calibration (drone powered OFF)</span>
<span class="p">{</span>
  <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="s2">&quot;petal-user-journey-coordinator/esc_calibration&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messageId&quot;</span><span class="p">:</span> <span class="s2">&quot;esc-cal-001&quot;</span><span class="p">,</span>
  <span class="s2">&quot;waitResponse&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;is_calibration_started&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
    <span class="s2">&quot;safety_timeout_s&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
    <span class="s2">&quot;force_cancel_calibration&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
    <span class="s2">&quot;esc_interface_signal_type&quot;</span><span class="p">:</span> <span class="s2">&quot;PWM&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ca_rotor_count&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s2">&quot;throttle&quot;</span><span class="p">:</span> <span class="n">null</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Step 2: Send maximum throttle (then power ON drone)</span>
<span class="p">{</span>
  <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="s2">&quot;petal-user-journey-coordinator/esc_calibration&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messageId&quot;</span><span class="p">:</span> <span class="s2">&quot;esc-cal-002&quot;</span><span class="p">,</span>
  <span class="s2">&quot;waitResponse&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;is_calibration_started&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;throttle&quot;</span><span class="p">:</span> <span class="s2">&quot;maximum&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Step 3: Send minimum throttle (after ESC beeps)</span>
<span class="p">{</span>
  <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="s2">&quot;petal-user-journey-coordinator/esc_calibration&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messageId&quot;</span><span class="p">:</span> <span class="s2">&quot;esc-cal-003&quot;</span><span class="p">,</span>
  <span class="s2">&quot;waitResponse&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;is_calibration_started&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;throttle&quot;</span><span class="p">:</span> <span class="s2">&quot;minimum&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Step 4: Stop motors</span>
<span class="p">{</span>
  <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="s2">&quot;petal-user-journey-coordinator/esc_calibration&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messageId&quot;</span><span class="p">:</span> <span class="s2">&quot;esc-cal-004&quot;</span><span class="p">,</span>
  <span class="s2">&quot;waitResponse&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;force_cancel_calibration&quot;</span><span class="p">:</span> <span class="n">true</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="esc-force-run-all">
<h3>esc_force_run_all<a class="headerlink" href="#esc-force-run-all" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/esc_force_run_all</span></code></p>
<p>Forces all motors to run simultaneously at a specified command level for testing purposes.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;motors_common_command&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;safety_timeout_s&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;force_cancel&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">motors_common_command</span></code> (float): Common command value for all motors [1000..1200]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">safety_timeout_s</span></code> (float): Safety timeout in seconds (0-3)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">force_cancel</span></code> (bool): Force cancel operation</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Ensure propellers are removed before running motor tests!</p>
</div>
</section>
<section id="esc-force-run-single">
<h3>esc_force_run_single<a class="headerlink" href="#esc-force-run-single" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/esc_force_run_single</span></code></p>
<p>Forces a single motor to run for individual motor testing.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;motor_idx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;motor_command&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;safety_timeout_s&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">2.5</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;force_cancel&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">motor_idx</span></code> (int): Motor index (1-based)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">motor_command</span></code> (float): Motor command value [1000..2000]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">safety_timeout_s</span></code> (float): Safety timeout in seconds (0-3)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">force_cancel</span></code> (bool): Force cancel operation</p></li>
</ul>
</section>
<section id="esc-calibration-single">
<h3>esc_calibration_single<a class="headerlink" href="#esc-calibration-single" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/esc_calibration_single</span></code></p>
<p>Initiates and controls ESC calibration for a <strong>single motor</strong>. This is useful when you need to calibrate ESCs individually rather than all at once. The workflow mirrors <code class="docutils literal notranslate"><span class="pre">esc_calibration</span></code> but targets only the specified motor.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;motor_idx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;is_calibration_started&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;safety_timeout_s&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">3.0</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;force_cancel_calibration&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;esc_interface_signal_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PWM&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;throttle&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;safe_stop_calibration&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">motor_idx</span></code> (int, required): Motor index (1-based). Cannot be changed while calibration is active.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_calibration_started</span></code> (bool, required): Whether calibration sequence has begun</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">safety_timeout_s</span></code> (float, required): Safety timeout in seconds (0-3) before automatic motor shutoff</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">force_cancel_calibration</span></code> (bool): Force stop the motor immediately (emergency stop)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">esc_interface_signal_type</span></code> (str): Signal type - <code class="docutils literal notranslate"><span class="pre">&quot;PWM&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;OneShot125&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;OneShot42&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Multishot&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;DShot150&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;DShot300&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;DShot600&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;DShot1200&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">throttle</span></code> (str|null): Throttle command - <code class="docutils literal notranslate"><span class="pre">&quot;maximum&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;minimum&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">null</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">safe_stop_calibration</span></code> (bool): Gracefully stop the calibration process</p></li>
</ul>
<p><strong>Example - Full Single-Motor Calibration Sequence:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 1: Initialize calibration for motor 1 (drone powered OFF)</span>
<span class="c1"># Sets PWM_AUX_TIM0, PWM_AUX_MAX/MIN/FUNC for the target motor</span>
<span class="p">{</span>
  <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="s2">&quot;petal-user-journey-coordinator/esc_calibration_single&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messageId&quot;</span><span class="p">:</span> <span class="s2">&quot;esc-cal-single-001&quot;</span><span class="p">,</span>
  <span class="s2">&quot;waitResponse&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;motor_idx&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;is_calibration_started&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
    <span class="s2">&quot;safety_timeout_s&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
    <span class="s2">&quot;force_cancel_calibration&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
    <span class="s2">&quot;esc_interface_signal_type&quot;</span><span class="p">:</span> <span class="s2">&quot;PWM&quot;</span><span class="p">,</span>
    <span class="s2">&quot;throttle&quot;</span><span class="p">:</span> <span class="n">null</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Step 2: Send maximum throttle to motor 1 (then power ON drone)</span>
<span class="p">{</span>
  <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="s2">&quot;petal-user-journey-coordinator/esc_calibration_single&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messageId&quot;</span><span class="p">:</span> <span class="s2">&quot;esc-cal-single-002&quot;</span><span class="p">,</span>
  <span class="s2">&quot;waitResponse&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;motor_idx&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;is_calibration_started&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;safety_timeout_s&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
    <span class="s2">&quot;throttle&quot;</span><span class="p">:</span> <span class="s2">&quot;maximum&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Step 3: Send minimum throttle to motor 1 (after ESC beeps)</span>
<span class="p">{</span>
  <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="s2">&quot;petal-user-journey-coordinator/esc_calibration_single&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messageId&quot;</span><span class="p">:</span> <span class="s2">&quot;esc-cal-single-003&quot;</span><span class="p">,</span>
  <span class="s2">&quot;waitResponse&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;motor_idx&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;is_calibration_started&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;safety_timeout_s&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
    <span class="s2">&quot;throttle&quot;</span><span class="p">:</span> <span class="s2">&quot;minimum&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Step 4: Gracefully stop calibration</span>
<span class="p">{</span>
  <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="s2">&quot;petal-user-journey-coordinator/esc_calibration_single&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messageId&quot;</span><span class="p">:</span> <span class="s2">&quot;esc-cal-single-004&quot;</span><span class="p">,</span>
  <span class="s2">&quot;waitResponse&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;motor_idx&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;is_calibration_started&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
    <span class="s2">&quot;safety_timeout_s&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
    <span class="s2">&quot;safe_stop_calibration&quot;</span><span class="p">:</span> <span class="n">true</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Alternative Step 4: Emergency stop (force cancel)</span>
<span class="p">{</span>
  <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="s2">&quot;petal-user-journey-coordinator/esc_calibration_single&quot;</span><span class="p">,</span>
  <span class="s2">&quot;messageId&quot;</span><span class="p">:</span> <span class="s2">&quot;esc-cal-single-005&quot;</span><span class="p">,</span>
  <span class="s2">&quot;waitResponse&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;motor_idx&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;is_calibration_started&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
    <span class="s2">&quot;safety_timeout_s&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
    <span class="s2">&quot;force_cancel_calibration&quot;</span><span class="p">:</span> <span class="n">true</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Response:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Single-motor ESC calibration state: maximum (motor 1)&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;calibration_state&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;maximum&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;is_active&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;target_motor&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Important Notes:</strong></p>
<ul class="simple">
<li><p>You <strong>cannot change</strong> <code class="docutils literal notranslate"><span class="pre">motor_idx</span></code> while a calibration is active. You will receive an error response asking you to stop the current calibration first via <code class="docutils literal notranslate"><span class="pre">safe_stop_calibration:</span> <span class="pre">true</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">throttle</span></code> value is only accepted when <code class="docutils literal notranslate"><span class="pre">is_calibration_started</span></code> is <code class="docutils literal notranslate"><span class="pre">true</span></code> and the controller is active.</p></li>
<li><p>The motor will automatically stop if <code class="docutils literal notranslate"><span class="pre">safety_timeout_s</span></code> elapses without receiving a new command.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">force_cancel_calibration:</span> <span class="pre">true</span></code> for emergency situations; use <code class="docutils literal notranslate"><span class="pre">safe_stop_calibration:</span> <span class="pre">true</span></code> for graceful shutdown.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Ensure propellers are removed before running ESC calibration!</p>
</div>
</section>
</section>
<section id="parameter-configuration-commands">
<h2>Parameter Configuration Commands<a class="headerlink" href="#parameter-configuration-commands" title="Link to this heading"></a></h2>
<p>These commands configure drone parameters on the flight controller.</p>
<section id="geometry">
<h3>geometry<a class="headerlink" href="#geometry" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/geometry</span></code></p>
<p>Configures the drone geometry (rotor count).</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;rotor_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rotor_count</span></code> (int): Number of rotors (4, 6, or 8)</p></li>
</ul>
</section>
<section id="gps-module">
<h3>gps_module<a class="headerlink" href="#gps-module" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/gps_module</span></code></p>
<p>Configures the GPS module type.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;gps_module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;u-blox NEO-M8N&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gps_module</span></code> (str): GPS module identifier</p></li>
</ul>
</section>
<section id="dist-module">
<h3>dist_module<a class="headerlink" href="#dist-module" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/dist_module</span></code></p>
<p>Configures the distance sensor module.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;dist_module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LiDAR Lite v3&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Supported Modules:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;LiDAR</span> <span class="pre">Lite</span> <span class="pre">v3&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;TFMini&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Benewake</span> <span class="pre">TF02&quot;</span></code></p></li>
<li><p>Other compatible distance sensors</p></li>
</ul>
</section>
<section id="oflow-module">
<h3>oflow_module<a class="headerlink" href="#oflow-module" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/oflow_module</span></code></p>
<p>Configures the optical flow sensor module.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;oflow_module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ARK Flow&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Supported Modules:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;ARK</span> <span class="pre">Flow&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;PX4Flow&quot;</span></code></p></li>
<li><p>Other compatible optical flow sensors</p></li>
</ul>
</section>
<section id="gps-spatial-offset">
<h3>gps_spatial_offset<a class="headerlink" href="#gps-spatial-offset" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/gps_spatial_offset</span></code></p>
<p>Sets the GPS antenna position offset relative to the drone’s center of mass.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;gps_module_spatial_offset_x_m&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.1</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;gps_module_spatial_offset_y_m&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;gps_module_spatial_offset_z_m&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-0.05</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gps_module_spatial_offset_x_m</span></code> (float): GPS X offset in meters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gps_module_spatial_offset_y_m</span></code> (float): GPS Y offset in meters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gps_module_spatial_offset_z_m</span></code> (float): GPS Z offset in meters</p></li>
</ul>
</section>
<section id="distance-spatial-offset">
<h3>distance_spatial_offset<a class="headerlink" href="#distance-spatial-offset" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/distance_spatial_offset</span></code></p>
<p>Sets the distance sensor position offset.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;dist_module_spatial_offset_x_m&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.05</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;dist_module_spatial_offset_y_m&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;dist_module_spatial_offset_z_m&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-0.1</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dist_module_spatial_offset_x_m</span></code> (float): Distance sensor X offset in meters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dist_module_spatial_offset_y_m</span></code> (float): Distance sensor Y offset in meters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dist_module_spatial_offset_z_m</span></code> (float): Distance sensor Z offset in meters</p></li>
</ul>
</section>
<section id="optical-flow-spatial-offset">
<h3>optical_flow_spatial_offset<a class="headerlink" href="#optical-flow-spatial-offset" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/optical_flow_spatial_offset</span></code></p>
<p>Sets the optical flow sensor position offset.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;oflow_module_spatial_offset_x_m&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;oflow_module_spatial_offset_y_m&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;oflow_module_spatial_offset_z_m&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-0.02</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">oflow_module_spatial_offset_x_m</span></code> (float): Optical flow X offset in meters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">oflow_module_spatial_offset_y_m</span></code> (float): Optical flow Y offset in meters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">oflow_module_spatial_offset_z_m</span></code> (float): Optical flow Z offset in meters</p></li>
</ul>
</section>
<section id="esc-update-calibration-limits">
<h3>esc_update_calibration_limits<a class="headerlink" href="#esc-update-calibration-limits" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/esc_update_calibration_limits</span></code></p>
<p>Updates ESC PWM calibration limits.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;motors_common_max_pwm&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2000</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;motors_common_min_pwm&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">motors_common_max_pwm</span></code> (int): Common maximum PWM value for all motors (1000-2000)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">motors_common_min_pwm</span></code> (int): Common minimum PWM value for all motors (1000-2000)</p></li>
</ul>
</section>
</section>
<section id="bulk-parameter-operations">
<h2>Bulk Parameter Operations<a class="headerlink" href="#bulk-parameter-operations" title="Link to this heading"></a></h2>
<p>These commands leverage the efficient bulk parameter operations for setting/getting multiple
PX4 parameters at once over potentially lossy connections. Both commands use a <strong>two-phase
response pattern</strong> (identical to <code class="docutils literal notranslate"><span class="pre">reboot_autopilot</span></code>):</p>
<ol class="arabic simple">
<li><p><strong>Immediate Response</strong> (via <code class="docutils literal notranslate"><span class="pre">send_command_response</span></code>): Acknowledges the command was received and validated</p></li>
<li><p><strong>Status Publish</strong> (via <code class="docutils literal notranslate"><span class="pre">publish_message</span></code>): Reports the final results after all parameters are processed</p></li>
</ol>
<section id="bulk-set-parameters">
<h3>bulk_set_parameters<a class="headerlink" href="#bulk-set-parameters" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/bulk_set_parameters</span></code></p>
<p>Sets multiple PX4 parameters in a single operation using the lossy-link optimized bulk setter.
The command validates the payload, immediately acknowledges receipt, then executes the bulk
set and publishes the results to <code class="docutils literal notranslate"><span class="pre">command/web</span></code>.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;parameter_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CA_ROTOR_COUNT&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;parameter_value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;parameter_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INT32&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;parameter_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;VTO_LOITER_ALT&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;parameter_value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">80.0</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;parameter_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;REAL32&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">parameters</span></code> (list): List of parameter objects, each containing:
- <code class="docutils literal notranslate"><span class="pre">parameter_name</span></code> (str): Name of the PX4 parameter
- <code class="docutils literal notranslate"><span class="pre">parameter_value</span></code> (str|int|float): Value to set
- <code class="docutils literal notranslate"><span class="pre">parameter_type</span></code> (str, optional): Parameter type - <code class="docutils literal notranslate"><span class="pre">&quot;UINT8&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;INT8&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;UINT16&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;INT16&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;UINT32&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;INT32&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;UINT64&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;INT64&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;REAL32&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;REAL64&quot;</span></code></p></li>
</ul>
<p><strong>Phase 1: Immediate Response (waitResponse)</strong></p>
<p>Sent immediately via <code class="docutils literal notranslate"><span class="pre">send_command_response</span></code> when <code class="docutils literal notranslate"><span class="pre">waitResponse:</span> <span class="pre">true</span></code>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bulk parameter set command initiated&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;parameter_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bulk parameter set in progress, results will be published to command/web&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Phase 1: Error Responses</strong></p>
<p>Error responses are sent immediately via <code class="docutils literal notranslate"><span class="pre">send_command_response</span></code> when <code class="docutils literal notranslate"><span class="pre">waitResponse:</span> <span class="pre">true</span></code>.</p>
<p><em>Operation Blocked:</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bulk parameter configuration blocked - Active operation in progress&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OPERATION_ACTIVE&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Empty Parameters:</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;No parameters provided for bulk set&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NO_PARAMETERS_PROVIDED&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Validation Error:</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Invalid bulk parameter payload: &lt;validation details&gt;&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;VALIDATION_ERROR&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Handler Error:</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bulk parameter handler error: &lt;error details&gt;&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HANDLER_ERROR&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Phase 2: Status Publish (publish_message)</strong></p>
<p>After all parameters are set (or the operation fails), the petal publishes the result to the
<code class="docutils literal notranslate"><span class="pre">command/web</span></code> MQTT topic. The front-end must subscribe to this topic and filter messages by
the <code class="docutils literal notranslate"><span class="pre">command</span></code> field.</p>
<p><strong>Status Publish Command Name Pattern:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>/&lt;petal_name&gt;/bulk-parameter-set
</pre></div>
</div>
<p>For this petal, the command will be:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>/petal-user-journey-coordinator/bulk-parameter-set
</pre></div>
</div>
<p><strong>Front-End Handling:</strong></p>
<p>The front-end should:</p>
<ol class="arabic simple">
<li><p>Subscribe to the <code class="docutils literal notranslate"><span class="pre">command/web</span></code> MQTT topic</p></li>
<li><p>Filter incoming messages by checking if <code class="docutils literal notranslate"><span class="pre">message.command</span></code> equals <code class="docutils literal notranslate"><span class="pre">/petal-user-journey-coordinator/bulk-parameter-set</span></code></p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">messageId</span></code> field to correlate the status with the original request</p></li>
</ol>
<p><strong>Status Publish (Success):</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;messageId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bulk-set-001&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/petal-user-journey-coordinator/bulk-parameter-set&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-12T12:00:05.000Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bulk parameter set completed - 2 parameters processed&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;results&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;CA_ROTOR_COUNT&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CA_ROTOR_COUNT&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;raw&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">4.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1053</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">65535</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;VTO_LOITER_ALT&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;VTO_LOITER_ALT&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">80.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;raw&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">80.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1053</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1047</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-12T12:00:05.000Z&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-12T12:00:05.000Z&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Status Publish (Partial Failure):</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;messageId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bulk-set-001&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/petal-user-journey-coordinator/bulk-parameter-set&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-12T12:00:05.000Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bulk parameter set completed - some parameters failed&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;results&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;CA_ROTOR_COUNT&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CA_ROTOR_COUNT&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;INVALID_PARAM&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INVALID_PARAM&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Parameter value could not be retrieved after set&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-12T12:00:05.000Z&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-12T12:00:05.000Z&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Status Publish (Error - No Parameters Confirmed):</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;messageId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bulk-set-001&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/petal-user-journey-coordinator/bulk-parameter-set&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-12T12:00:05.000Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;No parameters were confirmed after bulk set&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NO_PARAMETERS_CONFIRMED&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-12T12:00:05.000Z&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Status Payload Fields (BulkParameterStatusPayload):</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">success</span></code> (bool): <code class="docutils literal notranslate"><span class="pre">true</span></code> if all parameters were set successfully, <code class="docutils literal notranslate"><span class="pre">false</span></code> otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">status</span></code> (str): <code class="docutils literal notranslate"><span class="pre">&quot;success&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;error&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">message</span></code> (str): Human-readable status message</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">error_code</span></code> (str|null): Error code if the operation failed entirely:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">NO_PARAMETERS_CONFIRMED</span></code> - No parameters were confirmed after the bulk set</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXECUTION_ERROR</span></code> - Unexpected error during execution</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code> (object|null): <code class="docutils literal notranslate"><span class="pre">BulkParameterResponse</span></code> containing per-parameter results, or <code class="docutils literal notranslate"><span class="pre">null</span></code> on total failure</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timestamp</span></code> (str): ISO 8601 timestamp of when the operation completed</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">messageId</span></code> in both the immediate response and the status publish matches the
original request’s <code class="docutils literal notranslate"><span class="pre">messageId</span></code>, allowing the front-end to correlate responses with
their originating requests.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The bulk set command will be rejected if any ESC calibration, motor testing, or other
active operations are in progress. Ensure all operations are complete or cancelled
before attempting to set parameters.</p>
</div>
</section>
<section id="bulk-get-parameters">
<h3>bulk_get_parameters<a class="headerlink" href="#bulk-get-parameters" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/bulk_get_parameters</span></code></p>
<p>Retrieves multiple PX4 parameters in a single operation. The command validates the payload,
immediately acknowledges receipt, then executes the bulk get and publishes the results to
<code class="docutils literal notranslate"><span class="pre">command/web</span></code>.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;parameter_names&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;CA_ROTOR_COUNT&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;VTO_LOITER_ALT&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">parameter_names</span></code> (list): List of parameter name strings to retrieve</p></li>
</ul>
<p><strong>Phase 1: Immediate Response (waitResponse)</strong></p>
<p>Sent immediately via <code class="docutils literal notranslate"><span class="pre">send_command_response</span></code> when <code class="docutils literal notranslate"><span class="pre">waitResponse:</span> <span class="pre">true</span></code>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bulk parameter get command initiated&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;parameter_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bulk parameter get in progress, results will be published to command/web&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Phase 1: Error Responses</strong></p>
<p>Error responses are sent immediately via <code class="docutils literal notranslate"><span class="pre">send_command_response</span></code> when <code class="docutils literal notranslate"><span class="pre">waitResponse:</span> <span class="pre">true</span></code>.</p>
<p><em>Operation Blocked:</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bulk parameter retrieval blocked - Active operation in progress&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OPERATION_ACTIVE&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Empty Parameter Names:</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;No parameter names provided for bulk get&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NO_PARAMETER_NAMES_PROVIDED&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Validation Error:</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Invalid bulk parameter get payload: &lt;validation details&gt;&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;VALIDATION_ERROR&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Handler Error:</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bulk parameter get handler error: &lt;error details&gt;&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HANDLER_ERROR&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Phase 2: Status Publish (publish_message)</strong></p>
<p>After all parameters are retrieved (or the operation fails), the petal publishes the result to
the <code class="docutils literal notranslate"><span class="pre">command/web</span></code> MQTT topic.</p>
<p><strong>Status Publish Command Name Pattern:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>/&lt;petal_name&gt;/bulk-parameter-get
</pre></div>
</div>
<p>For this petal, the command will be:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>/petal-user-journey-coordinator/bulk-parameter-get
</pre></div>
</div>
<p><strong>Front-End Handling:</strong></p>
<p>The front-end should:</p>
<ol class="arabic simple">
<li><p>Subscribe to the <code class="docutils literal notranslate"><span class="pre">command/web</span></code> MQTT topic</p></li>
<li><p>Filter incoming messages by checking if <code class="docutils literal notranslate"><span class="pre">message.command</span></code> equals <code class="docutils literal notranslate"><span class="pre">/petal-user-journey-coordinator/bulk-parameter-get</span></code></p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">messageId</span></code> field to correlate the status with the original request</p></li>
</ol>
<p><strong>Status Publish (Success):</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;messageId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bulk-get-001&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/petal-user-journey-coordinator/bulk-parameter-get&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-12T12:00:05.000Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bulk parameter get completed - 2 parameters processed&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;results&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;CA_ROTOR_COUNT&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CA_ROTOR_COUNT&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;raw&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">4.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1053</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">65535</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;VTO_LOITER_ALT&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;VTO_LOITER_ALT&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">80.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;raw&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">80.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1053</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1047</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-12T12:00:05.000Z&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-12T12:00:05.000Z&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Status Publish (Partial Failure):</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;messageId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bulk-get-001&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/petal-user-journey-coordinator/bulk-parameter-get&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-12T12:00:05.000Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bulk parameter get completed - some parameters failed&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;results&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;CA_ROTOR_COUNT&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CA_ROTOR_COUNT&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;INVALID_PARAM&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INVALID_PARAM&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Parameter value could not be retrieved&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-12T12:00:05.000Z&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-12T12:00:05.000Z&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Status Publish (Error - No Parameters Confirmed):</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;messageId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bulk-get-001&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/petal-user-journey-coordinator/bulk-parameter-get&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-12T12:00:05.000Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;No parameters were confirmed after bulk get&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NO_PARAMETERS_CONFIRMED&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-12T12:00:05.000Z&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Status Payload Fields (BulkParameterStatusPayload):</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">success</span></code> (bool): <code class="docutils literal notranslate"><span class="pre">true</span></code> if all parameters were retrieved successfully, <code class="docutils literal notranslate"><span class="pre">false</span></code> otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">status</span></code> (str): <code class="docutils literal notranslate"><span class="pre">&quot;success&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;error&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">message</span></code> (str): Human-readable status message</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">error_code</span></code> (str|null): Error code if the operation failed entirely:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">NO_PARAMETERS_CONFIRMED</span></code> - No parameters were confirmed after the bulk get</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXECUTION_ERROR</span></code> - Unexpected error during execution</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code> (object|null): <code class="docutils literal notranslate"><span class="pre">BulkParameterResponse</span></code> containing per-parameter results, or <code class="docutils literal notranslate"><span class="pre">null</span></code> on total failure</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timestamp</span></code> (str): ISO 8601 timestamp of when the operation completed</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">messageId</span></code> in both the immediate response and the status publish matches the
original request’s <code class="docutils literal notranslate"><span class="pre">messageId</span></code>, allowing the front-end to correlate responses with
their originating requests.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The bulk get command will be rejected if any ESC calibration, motor testing, or other
active operations are in progress. Ensure all operations are complete or cancelled
before attempting to retrieve parameters.</p>
</div>
</section>
</section>
<section id="real-time-telemetry-streams">
<h2>Real-Time Telemetry Streams<a class="headerlink" href="#real-time-telemetry-streams" title="Link to this heading"></a></h2>
<p>These commands subscribe/unsubscribe to real-time data streams from the flight controller.</p>
<section id="subscribe-rc-value-stream">
<h3>subscribe_rc_value_stream<a class="headerlink" href="#subscribe-rc-value-stream" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/subscribe_rc_value_stream</span></code></p>
<p>Subscribes to RC (Remote Control) channel values for monitoring transmitter inputs.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;subscribed_stream_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;px4_rc_raw&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;data_rate_hz&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">50.0</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">subscribed_stream_id</span></code> (str): Unique identifier for this subscription</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data_rate_hz</span></code> (float): Data publishing rate in Hz (1-100)</p></li>
</ul>
<p><strong>Stream Data Format:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;stream_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;px4_rc_raw&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-01-07T12:00:00.000Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;channels&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1500</span><span class="p">,</span><span class="w"> </span><span class="mi">1500</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="mi">1500</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="mi">1500</span><span class="p">,</span><span class="w"> </span><span class="mi">1500</span><span class="p">,</span><span class="w"> </span><span class="mi">1500</span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;rssi&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;channel_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="unsubscribe-rc-value-stream">
<h3>unsubscribe_rc_value_stream<a class="headerlink" href="#unsubscribe-rc-value-stream" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/unsubscribe_rc_value_stream</span></code></p>
<p>Unsubscribes from RC channel stream.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;unsubscribed_stream_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;px4_rc_raw&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="subscribe-pose-value-stream">
<h3>subscribe_pose_value_stream<a class="headerlink" href="#subscribe-pose-value-stream" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/subscribe_pose_value_stream</span></code></p>
<p>Subscribes to real-time position and orientation data.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;subscribed_stream_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;real_time_pose&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;data_rate_hz&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">20.0</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Stream Data Format:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;stream_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;real_time_pose&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-01-07T12:00:00.000Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;position&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;z&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-1.5</span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;velocity&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;vx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;vy&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;vz&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;attitude&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;roll&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;pitch&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;yaw&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;heading&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">90.0</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="unsubscribe-pose-value-stream">
<h3>unsubscribe_pose_value_stream<a class="headerlink" href="#unsubscribe-pose-value-stream" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/unsubscribe_pose_value_stream</span></code></p>
<p>Unsubscribes from pose stream.</p>
</section>
<section id="subscribe-ks-status-stream">
<h3>subscribe_ks_status_stream<a class="headerlink" href="#subscribe-ks-status-stream" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/subscribe_ks_status_stream</span></code></p>
<p>Subscribes to kill switch status monitoring.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;subscribed_stream_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;px4_ks_status&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;data_rate_hz&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">5.0</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Stream Data Format:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;stream_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;px4_ks_status&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-01-07T12:00:00.000Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;kill_switch_engaged&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;channel_value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="unsubscribe-ks-status-stream">
<h3>unsubscribe_ks_status_stream<a class="headerlink" href="#unsubscribe-ks-status-stream" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/unsubscribe_ks_status_stream</span></code></p>
<p>Unsubscribes from kill switch stream.</p>
</section>
<section id="subscribe-mfs-a-status-stream-subscribe-mfs-b-status-stream">
<h3>subscribe_mfs_a_status_stream / subscribe_mfs_b_status_stream<a class="headerlink" href="#subscribe-mfs-a-status-stream-subscribe-mfs-b-status-stream" title="Link to this heading"></a></h3>
<p><strong>Commands:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/subscribe_mfs_a_status_stream</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/subscribe_mfs_b_status_stream</span></code></p></li>
</ul>
<p>Subscribes to multi-functional switch A or B status streams.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;subscribed_stream_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;px4_mfs_a_raw&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;data_rate_hz&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">10.0</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="unsubscribeall">
<h3>unsubscribeall<a class="headerlink" href="#unsubscribeall" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/unsubscribeall</span></code></p>
<p>Unsubscribes from all active telemetry streams.</p>
<p><strong>Payload:</strong> None required</p>
<p><strong>Response:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Unsubscribed from 3 streams&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;unsubscribed_streams&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;stream_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;rc_value_stream&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;stream_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;px4_rc_raw&quot;</span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;stream_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pose_value_stream&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;stream_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;real_time_pose&quot;</span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;stream_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ks_status_stream&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;stream_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;px4_ks_status&quot;</span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="trajectory-verification-commands">
<h2>Trajectory Verification Commands<a class="headerlink" href="#trajectory-verification-commands" title="Link to this heading"></a></h2>
<p>These commands support automated trajectory verification for drone movement testing.</p>
<section id="verify-pos-yaw-directions">
<h3>verify_pos_yaw_directions<a class="headerlink" href="#verify-pos-yaw-directions" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/verify_pos_yaw_directions</span></code></p>
<p>Starts a trajectory verification sequence where the drone follows a predefined rectangular path to verify position and yaw accuracy.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;rectangle_width&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">3.0</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;rectangle_height&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">3.0</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;points_per_edge&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rectangle_width</span></code> (float): Width of test rectangle in meters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rectangle_height</span></code> (float): Height of test rectangle in meters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">points_per_edge</span></code> (int): Number of waypoints per edge</p></li>
</ul>
</section>
<section id="verify-pos-yaw-directions-complete">
<h3>verify_pos_yaw_directions_complete<a class="headerlink" href="#verify-pos-yaw-directions-complete" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/verify_pos_yaw_directions_complete</span></code></p>
<p>Completes the trajectory verification and retrieves results.</p>
<p><strong>Response:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;verification_result&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;total_points&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;matched_points&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">38</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;accuracy_percent&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">95.0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;max_position_error_m&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.15</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;max_yaw_error_deg&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">5.2</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;trajectory_data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="wifi-optitrack-commands">
<h2>WiFi &amp; OptiTrack Commands<a class="headerlink" href="#wifi-optitrack-commands" title="Link to this heading"></a></h2>
<p>These commands manage WiFi connectivity and OptiTrack motion capture system integration.</p>
<section id="connect-to-wifi-and-verify-optitrack">
<h3>connect_to_wifi_and_verify_optitrack<a class="headerlink" href="#connect-to-wifi-and-verify-optitrack" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/connect_to_wifi_and_verify_optitrack</span></code></p>
<p>Connects to a WiFi network and verifies OptiTrack motion capture connectivity.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;positioning_system_network_wifi_ssid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OptiTrack_Network&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;positioning_system_network_wifi_pass&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;password123&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;positioning_system_network_wifi_subnet&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.1.0/24&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;positioning_system_network_server_ip_address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.1.100&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;positioning_system_network_server_multicast_address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;239.255.42.99&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;positioning_system_network_server_data_port&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1511&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">positioning_system_network_wifi_ssid</span></code> (str): WiFi SSID to connect to</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">positioning_system_network_wifi_pass</span></code> (str): WiFi password</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">positioning_system_network_wifi_subnet</span></code> (str): Expected subnet (e.g., ‘192.168.1.0/24’)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">positioning_system_network_server_ip_address</span></code> (str): OptiTrack server IP address to ping</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">positioning_system_network_server_multicast_address</span></code> (str): Multicast address for OptiTrack</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">positioning_system_network_server_data_port</span></code> (str): Data port for OptiTrack communication</p></li>
</ul>
<p><strong>Response:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;was_successful&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;status_message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Successfully connected to WiFi and verified OptiTrack server connectivity&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;assigned_ip_address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.1.45&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="set-static-ip-address">
<h3>set_static_ip_address<a class="headerlink" href="#set-static-ip-address" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/set_static_ip_address</span></code></p>
<p>Sets a static IP address within the OptiTrack network.</p>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;positioning_system_network_wifi_subnet&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;255.255.255.0&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;positioning_system_network_server_ip_address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.27&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">positioning_system_network_wifi_subnet</span></code> (str): Subnet mask (e.g., ‘255.255.255.0’ or ‘10.0.0.0/24’)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">positioning_system_network_server_ip_address</span></code> (str): OptiTrack server IP address for gateway calculation</p></li>
</ul>
<p><strong>Response:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;assigned_static_ip&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.25&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;was_successful&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="system-commands">
<h2>System Commands<a class="headerlink" href="#system-commands" title="Link to this heading"></a></h2>
<p>These commands provide system-level operations for the flight controller.</p>
<section id="reboot-px4">
<h3>reboot_px4<a class="headerlink" href="#reboot-px4" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/reboot_autopilot</span></code></p>
<p>Reboots the PX4 flight controller with full heartbeat confirmation. The command sends
<code class="docutils literal notranslate"><span class="pre">MAV_CMD_PREFLIGHT_REBOOT_SHUTDOWN</span></code>, then waits for the autopilot heartbeat to <strong>drop</strong>
(confirming the reboot started) and <strong>return</strong> (confirming the autopilot is alive again).
This uses a two-phase response pattern:</p>
<ol class="arabic simple">
<li><p><strong>Immediate Response</strong> (via <code class="docutils literal notranslate"><span class="pre">send_command_response</span></code>): Acknowledges the command was received</p></li>
<li><p><strong>Status Publish</strong> (via <code class="docutils literal notranslate"><span class="pre">publish_message</span></code>): Reports the <strong>confirmed</strong> reboot result after heartbeat returns</p></li>
</ol>
<p><strong>Understanding ``waitResponse``:</strong></p>
<p>When <code class="docutils literal notranslate"><span class="pre">waitResponse:</span> <span class="pre">true</span></code> is set in the request, the petal will call <code class="docutils literal notranslate"><span class="pre">send_command_response</span></code> to deliver an immediate acknowledgement back to the client. This response is delivered via the MQTT proxy’s request-response mechanism and confirms:</p>
<ul class="simple">
<li><p>The command was received and validated</p></li>
<li><p>No blocking operations are in progress</p></li>
<li><p>The reboot process has been initiated</p></li>
</ul>
<p>The client does <strong>not</strong> wait for the actual reboot to complete—that would block for up to
~35 seconds (ACK timeout + heartbeat drop window + heartbeat return window).</p>
<p><strong>Payload:</strong> None required (empty object <code class="docutils literal notranslate"><span class="pre">{}</span></code>)</p>
<p><strong>Phase 1: Immediate Response (waitResponse)</strong></p>
<p>Sent immediately via <code class="docutils literal notranslate"><span class="pre">send_command_response</span></code> when <code class="docutils literal notranslate"><span class="pre">waitResponse:</span> <span class="pre">true</span></code>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PX4 reboot command initiated&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;reboot_initiated&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Reboot in progress, confirmed status will be published to command/web&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Phase 1: Error Responses</strong></p>
<p>Error responses are sent immediately via <code class="docutils literal notranslate"><span class="pre">send_command_response</span></code> when <code class="docutils literal notranslate"><span class="pre">waitResponse:</span> <span class="pre">true</span></code>.</p>
<p><em>Operation Blocked:</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PX4 reboot blocked - Active operation in progress&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OPERATION_ACTIVE&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Validation Error:</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Invalid PX4 reboot message: &lt;validation details&gt;&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;VALIDATION_ERROR&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Handler Error:</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PX4 reboot message handler error: &lt;error details&gt;&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HANDLER_ERROR&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Phase 2: Status Publish (publish_message)</strong></p>
<p>After the reboot completes (or fails), the petal publishes the result to the <code class="docutils literal notranslate"><span class="pre">command/web</span></code> MQTT topic. The front-end must subscribe to this topic and filter messages by the <code class="docutils literal notranslate"><span class="pre">command</span></code> field.</p>
<p><strong>Status Publish Command Name Pattern:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>/&lt;petal_name&gt;/reboot_px4_status
</pre></div>
</div>
<p>For this petal, the command will be:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>/petal-user-journey-coordinator/reboot_px4_status
</pre></div>
</div>
<p><strong>Front-End Handling:</strong></p>
<p>The front-end should:</p>
<ol class="arabic simple">
<li><p>Subscribe to the <code class="docutils literal notranslate"><span class="pre">command/web</span></code> MQTT topic</p></li>
<li><p>Filter incoming messages by checking if <code class="docutils literal notranslate"><span class="pre">message.command</span></code> equals <code class="docutils literal notranslate"><span class="pre">/petal-user-journey-coordinator/reboot_px4_status</span></code></p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">messageId</span></code> field to correlate the status with the original request</p></li>
</ol>
<p><strong>Status Publish (Success):</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;messageId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;reboot-001&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/petal-user-journey-coordinator/reboot_px4_status&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-01-07T12:00:05.000Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;reboot_initiated&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;reboot_success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Reboot confirmed: COMMAND_ACK accepted and heartbeat drop + return observed.&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-01-07T12:00:05.000Z&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Status Publish (Failed):</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;messageId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;reboot-001&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/petal-user-journey-coordinator/reboot_px4_status&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-01-07T12:00:05.000Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;reboot_initiated&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;reboot_success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;failed&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Heartbeat drop observed but heartbeat did not return within 30.0s. Autopilot may still be rebooting.&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;FAIL_REBOOT_NOT_CONFIRMED_HB_NO_RETURN&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-01-07T12:00:05.000Z&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Status Payload Fields:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reboot_initiated</span></code> (bool): Always <code class="docutils literal notranslate"><span class="pre">true</span></code> if status is published (reboot was attempted)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reboot_success</span></code> (bool): <code class="docutils literal notranslate"><span class="pre">true</span></code> if reboot succeeded, <code class="docutils literal notranslate"><span class="pre">false</span></code> if it failed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">status</span></code> (str): <code class="docutils literal notranslate"><span class="pre">&quot;success&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;failed&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">message</span></code> (str): Human-readable status message from the MAVLink response</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">error_code</span></code> (str|null): Error code if failed, from <code class="docutils literal notranslate"><span class="pre">RebootStatusCode</span></code>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">FAIL_ACK_DENIED</span></code> - Autopilot rejected the command</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FAIL_ACK_TEMPORARILY_REJECTED</span></code> - Temporarily rejected</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FAIL_NO_HEARTBEAT_TRACKING</span></code> - Heartbeat tracking unavailable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FAIL_REBOOT_NOT_CONFIRMED_NO_HB_DROP</span></code> - Heartbeat did not drop</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FAIL_REBOOT_NOT_CONFIRMED_HB_NO_RETURN</span></code> - Heartbeat dropped but did not return</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXECUTION_ERROR</span></code> - Unexpected error during reboot</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">timestamp</span></code> (str): ISO 8601 timestamp of when the reboot completed</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The reboot command will be rejected if any ESC calibration, motor testing, or other
active operations are in progress. Ensure all operations are complete or cancelled
before attempting to reboot.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">messageId</span></code> in both the immediate response and the status publish matches the
original request’s <code class="docutils literal notranslate"><span class="pre">messageId</span></code>, allowing the front-end to correlate responses with
their originating requests.</p>
</div>
</section>
<section id="format-sd-card">
<h3>format_sd_card<a class="headerlink" href="#format-sd-card" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/format_sd_card</span></code></p>
<p>Formats the Pixhawk SD card. This uses a two-phase response pattern:</p>
<ol class="arabic simple">
<li><p><strong>Immediate Response</strong> (via <code class="docutils literal notranslate"><span class="pre">send_command_response</span></code>): Acknowledges the command was received</p></li>
<li><p><strong>Status Publish</strong> (via <code class="docutils literal notranslate"><span class="pre">publish_message</span></code>): Reports the format result after completion</p></li>
</ol>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;storage_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">storage_id</span></code> (int): Storage device ID to format (0-3, default: 0 = primary SD card)</p></li>
</ul>
<p><strong>Phase 1: Immediate Response (waitResponse)</strong></p>
<p>Sent immediately via <code class="docutils literal notranslate"><span class="pre">send_command_response</span></code> when <code class="docutils literal notranslate"><span class="pre">waitResponse:</span> <span class="pre">true</span></code>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Format SD card command initiated&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;format_initiated&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;storage_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Format in progress, status will be published to command/web&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Phase 1: Error Responses</strong></p>
<p>Error responses are sent immediately via <code class="docutils literal notranslate"><span class="pre">send_command_response</span></code> when <code class="docutils literal notranslate"><span class="pre">waitResponse:</span> <span class="pre">true</span></code>.</p>
<p><em>Operation Blocked:</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SD card format blocked - Active operation in progress&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OPERATION_ACTIVE&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Validation Error:</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Invalid format SD card message: &lt;validation details&gt;&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;VALIDATION_ERROR&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Handler Error:</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Format SD card message handler error: &lt;error details&gt;&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HANDLER_ERROR&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Phase 2: Status Publish (publish_message)</strong></p>
<p>After the format completes (or fails), the petal publishes the result to the <code class="docutils literal notranslate"><span class="pre">command/web</span></code> MQTT topic.</p>
<p><strong>Status Publish Command Name Pattern:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>/&lt;petal_name&gt;/format_sd_card_status
</pre></div>
</div>
<p>For this petal, the command will be:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>/petal-user-journey-coordinator/format_sd_card_status
</pre></div>
</div>
<p><strong>Front-End Handling:</strong></p>
<p>The front-end should:</p>
<ol class="arabic simple">
<li><p>Subscribe to the <code class="docutils literal notranslate"><span class="pre">command/web</span></code> MQTT topic</p></li>
<li><p>Filter incoming messages by checking if <code class="docutils literal notranslate"><span class="pre">message.command</span></code> equals <code class="docutils literal notranslate"><span class="pre">/petal-user-journey-coordinator/format_sd_card_status</span></code></p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">messageId</span></code> field to correlate the status with the original request</p></li>
</ol>
<p><strong>Status Publish (Success):</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;messageId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;format-001&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/petal-user-journey-coordinator/format_sd_card_status&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-18T12:00:05.000Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;format_initiated&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;format_success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SD card format completed successfully&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;storage_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-18T12:00:05.000Z&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Status Publish (Failed):</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;messageId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;format-001&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/petal-user-journey-coordinator/format_sd_card_status&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-18T12:00:05.000Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;format_initiated&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;format_success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;failed&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Format storage command timed out&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;TIMEOUT&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;storage_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-18T12:00:05.000Z&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Status Payload Fields (FormatSDCardStatusPayload):</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">format_initiated</span></code> (bool): Always <code class="docutils literal notranslate"><span class="pre">true</span></code> if status is published (format was attempted)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">format_success</span></code> (bool): <code class="docutils literal notranslate"><span class="pre">true</span></code> if format succeeded, <code class="docutils literal notranslate"><span class="pre">false</span></code> if it failed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">status</span></code> (str): <code class="docutils literal notranslate"><span class="pre">&quot;success&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;failed&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">message</span></code> (str): Human-readable status message</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">error_code</span></code> (str|null): Error code if failed:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">TIMEOUT</span></code> - Format command timed out</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DENIED</span></code> - Command denied by autopilot</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">UNSUPPORTED</span></code> - Command not supported</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXECUTION_ERROR</span></code> - Unexpected error during format</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PAYLOAD_VALIDATION_ERROR</span></code> - Status payload validation failed</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">storage_id</span></code> (int): Storage device ID that was formatted</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timestamp</span></code> (str): ISO 8601 timestamp of when the format completed</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Formatting the SD card permanently erases <strong>all</strong> data on the Pixhawk’s SD card, including
all ULog files. Ensure important logs have been synced before formatting.</p>
</div>
</section>
<section id="get-log-entries">
<h3>get_log_entries<a class="headerlink" href="#get-log-entries" title="Link to this heading"></a></h3>
<p><strong>Command:</strong> <code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/get_log_entries</span></code></p>
<p>Retrieves log entry metadata from the flight controller by sending a <code class="docutils literal notranslate"><span class="pre">LOG_REQUEST_LIST</span></code>
MAVLink message and collecting <code class="docutils literal notranslate"><span class="pre">LOG_ENTRY</span></code> responses. This is a diagnostic/test endpoint
for inspecting available logs on the vehicle. This uses a two-phase response pattern:</p>
<ol class="arabic simple">
<li><p><strong>Immediate Response</strong> (via <code class="docutils literal notranslate"><span class="pre">send_command_response</span></code>): Acknowledges the command was received</p></li>
<li><p><strong>Status Publish</strong> (via <code class="docutils literal notranslate"><span class="pre">publish_message</span></code>): Reports the retrieval result with log entries</p></li>
</ol>
<p><strong>Payload:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;timeout&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">5.0</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">timeout</span></code> (float): Timeout in seconds for log entry retrieval (1.0-30.0, default: 5.0)</p></li>
</ul>
<p><strong>Phase 1: Immediate Response (waitResponse)</strong></p>
<p>Sent immediately via <code class="docutils literal notranslate"><span class="pre">send_command_response</span></code> when <code class="docutils literal notranslate"><span class="pre">waitResponse:</span> <span class="pre">true</span></code>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Log retrieval command initiated&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;retrieval_initiated&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;timeout&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">5.0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Retrieving log entries, status will be published to command/web&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Phase 1: Error Responses</strong></p>
<p>Error responses are sent immediately via <code class="docutils literal notranslate"><span class="pre">send_command_response</span></code> when <code class="docutils literal notranslate"><span class="pre">waitResponse:</span> <span class="pre">true</span></code>.</p>
<p><em>Operation Blocked:</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Log retrieval blocked - Active operation in progress&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OPERATION_ACTIVE&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Validation Error:</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Invalid get log entries message: &lt;validation details&gt;&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;VALIDATION_ERROR&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Handler Error:</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Get log entries message handler error: &lt;error details&gt;&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HANDLER_ERROR&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Phase 2: Status Publish (publish_message)</strong></p>
<p>After log retrieval completes (or fails), the petal publishes the result to the <code class="docutils literal notranslate"><span class="pre">command/web</span></code> MQTT topic.</p>
<p><strong>Status Publish Command Name Pattern:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>/&lt;petal_name&gt;/get_log_entries_status
</pre></div>
</div>
<p>For this petal, the command will be:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>/petal-user-journey-coordinator/get_log_entries_status
</pre></div>
</div>
<p><strong>Front-End Handling:</strong></p>
<p>The front-end should:</p>
<ol class="arabic simple">
<li><p>Subscribe to the <code class="docutils literal notranslate"><span class="pre">command/web</span></code> MQTT topic</p></li>
<li><p>Filter incoming messages by checking if <code class="docutils literal notranslate"><span class="pre">message.command</span></code> equals <code class="docutils literal notranslate"><span class="pre">/petal-user-journey-coordinator/get_log_entries_status</span></code></p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">messageId</span></code> field to correlate the status with the original request</p></li>
</ol>
<p><strong>Status Publish (Success):</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;messageId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;log-001&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/petal-user-journey-coordinator/get_log_entries_status&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-18T12:00:05.000Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;retrieval_initiated&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;retrieval_success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Retrieved 5 log entries from vehicle&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;total_logs&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;log_entries&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;0&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1048576</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;utc&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1705323022</span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;1&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">524288</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;utc&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1705323100</span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;2&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">262144</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;utc&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1705323200</span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;3&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">131072</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;utc&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1705323300</span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;4&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">65536</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;utc&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1705323400</span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-18T12:00:05.000Z&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Status Publish (Failed - Timeout):</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;messageId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;log-001&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/petal-user-journey-coordinator/get_log_entries_status&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-18T12:00:05.000Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;retrieval_initiated&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;retrieval_success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;failed&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Log retrieval failed: Timed out waiting for LOG_ENTRY packets&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RETRIEVAL_TIMEOUT&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;total_logs&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;log_entries&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-18T12:00:05.000Z&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Status Payload Fields (LogRetrievalStatusPayload):</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">retrieval_initiated</span></code> (bool): Always <code class="docutils literal notranslate"><span class="pre">true</span></code> if status is published</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">retrieval_success</span></code> (bool): <code class="docutils literal notranslate"><span class="pre">true</span></code> if retrieval succeeded, <code class="docutils literal notranslate"><span class="pre">false</span></code> if it failed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">status</span></code> (str): <code class="docutils literal notranslate"><span class="pre">&quot;success&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;failed&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">message</span></code> (str): Human-readable status message</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">error_code</span></code> (str|null): Error code if failed:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">RETRIEVAL_TIMEOUT</span></code> - Timed out waiting for LOG_ENTRY packets</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RUNTIME_ERROR</span></code> - MAVLink runtime error during retrieval</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXECUTION_ERROR</span></code> - Unexpected error during retrieval</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PAYLOAD_VALIDATION_ERROR</span></code> - Status payload validation failed</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_logs</span></code> (int): Number of log entries retrieved (0 on failure)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log_entries</span></code> (object|null): Dict keyed by log ID (as string) with values containing:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">size</span></code> (int): Log file size in bytes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">utc</span></code> (int): UTC timestamp of the log entry (Unix epoch seconds)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">timestamp</span></code> (str): ISO 8601 timestamp of when the retrieval completed</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">log_entries</span></code> field keys are log IDs as strings. Each entry contains <code class="docutils literal notranslate"><span class="pre">size</span></code> (bytes)
and <code class="docutils literal notranslate"><span class="pre">utc</span></code> (Unix timestamp) metadata from the flight controller’s LOG_ENTRY MAVLink message.</p>
</div>
</section>
</section>
<section id="complete-usage-example">
<h2>Complete Usage Example<a class="headerlink" href="#complete-usage-example" title="Link to this heading"></a></h2>
<p>Here’s a complete example of configuring a drone using multiple commands:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">paho.mqtt.client</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mqtt</span>

<span class="c1"># Connect to MQTT broker</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">mqtt</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="mi">1883</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">send_command</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">payload</span><span class="p">,</span> <span class="n">message_id</span><span class="p">):</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="n">command</span><span class="p">,</span>
        <span class="s2">&quot;messageId&quot;</span><span class="p">:</span> <span class="n">message_id</span><span class="p">,</span>
        <span class="s2">&quot;waitResponse&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">payload</span>
    <span class="p">}</span>
    <span class="n">client</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="s2">&quot;command/edge&quot;</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>

<span class="c1"># 1. Configure geometry</span>
<span class="n">send_command</span><span class="p">(</span>
    <span class="s2">&quot;petal-user-journey-coordinator/geometry&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s2">&quot;rotor_count&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
    <span class="s2">&quot;config-001&quot;</span>
<span class="p">)</span>

<span class="c1"># 2. Set GPS offset</span>
<span class="n">send_command</span><span class="p">(</span>
    <span class="s2">&quot;petal-user-journey-coordinator/gps_spatial_offset&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;gps_module_spatial_offset_x_m&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
        <span class="s2">&quot;gps_module_spatial_offset_y_m&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">&quot;gps_module_spatial_offset_z_m&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.02</span>
    <span class="p">},</span>
    <span class="s2">&quot;config-002&quot;</span>
<span class="p">)</span>

<span class="c1"># 3. Bulk set flight parameters</span>
<span class="n">send_command</span><span class="p">(</span>
    <span class="s2">&quot;petal-user-journey-coordinator/bulk_set_parameters&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s2">&quot;parameter_name&quot;</span><span class="p">:</span> <span class="s2">&quot;NAV_ACC_RAD&quot;</span><span class="p">,</span> <span class="s2">&quot;parameter_value&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;parameter_type&quot;</span><span class="p">:</span> <span class="s2">&quot;REAL32&quot;</span><span class="p">},</span>
            <span class="p">{</span><span class="s2">&quot;parameter_name&quot;</span><span class="p">:</span> <span class="s2">&quot;MPC_XY_VEL_MAX&quot;</span><span class="p">,</span> <span class="s2">&quot;parameter_value&quot;</span><span class="p">:</span> <span class="mf">12.0</span><span class="p">,</span> <span class="s2">&quot;parameter_type&quot;</span><span class="p">:</span> <span class="s2">&quot;REAL32&quot;</span><span class="p">},</span>
            <span class="p">{</span><span class="s2">&quot;parameter_name&quot;</span><span class="p">:</span> <span class="s2">&quot;MPC_Z_VEL_MAX_UP&quot;</span><span class="p">,</span> <span class="s2">&quot;parameter_value&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s2">&quot;parameter_type&quot;</span><span class="p">:</span> <span class="s2">&quot;REAL32&quot;</span><span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">&quot;config-003&quot;</span>
<span class="p">)</span>

<span class="c1"># 4. Subscribe to pose stream for verification</span>
<span class="n">send_command</span><span class="p">(</span>
    <span class="s2">&quot;petal-user-journey-coordinator/subscribe_pose_value_stream&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s2">&quot;subscribed_stream_id&quot;</span><span class="p">:</span> <span class="s2">&quot;verification_pose&quot;</span><span class="p">,</span> <span class="s2">&quot;data_rate_hz&quot;</span><span class="p">:</span> <span class="mf">20.0</span><span class="p">},</span>
    <span class="s2">&quot;stream-001&quot;</span>
<span class="p">)</span>

<span class="c1"># 5. Cleanup - unsubscribe all</span>
<span class="n">send_command</span><span class="p">(</span>
    <span class="s2">&quot;petal-user-journey-coordinator/unsubscribeall&quot;</span><span class="p">,</span>
    <span class="p">{},</span>
    <span class="s2">&quot;cleanup-001&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="error-handling">
<h2>Error Handling<a class="headerlink" href="#error-handling" title="Link to this heading"></a></h2>
<p>All commands return error responses in a consistent format:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Detailed error description&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ERROR_CODE&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-01-07T12:00:00.000Z&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Common Error Codes:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">UNKNOWN_COMMAND</span></code> - Command not recognized</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VALIDATION_ERROR</span></code> - Invalid payload format</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TIMEOUT_ERROR</span></code> - Operation timed out</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MAVLINK_ERROR</span></code> - MAVLink communication failed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NOT_INITIALIZED</span></code> - Petal not fully initialized</p></li>
</ul>
</section>
<section id="mqtt-topics-reference">
<h2>MQTT Topics Reference<a class="headerlink" href="#mqtt-topics-reference" title="Link to this heading"></a></h2>
<p>This section provides a comprehensive reference of all MQTT topics used by the petal.</p>
<section id="commands-received-on-command-edge">
<h3>Commands (Received on <code class="docutils literal notranslate"><span class="pre">command/edge</span></code>)<a class="headerlink" href="#commands-received-on-command-edge" title="Link to this heading"></a></h3>
<p>Commands are received on the <code class="docutils literal notranslate"><span class="pre">command/edge</span></code> topic with the following format:
<code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/&lt;command_name&gt;</span></code></p>
<p><strong>ESC Calibration:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/esc_calibration</span></code> - ESC calibration control (all motors)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/esc_calibration_single</span></code> - ESC calibration control (single motor)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/esc_force_run_all</span></code> - Force run all motors</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/esc_force_run_single</span></code> - Force run single motor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/esc_update_calibration_limits</span></code> - Update ESC calibration limits</p></li>
</ul>
<p><strong>Geometry &amp; Sensor Configuration:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/geometry</span></code> - Set drone geometry</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/gps_module</span></code> - Configure GPS module</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/dist_module</span></code> - Configure distance sensor module</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/oflow_module</span></code> - Configure optical flow module</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/gps_spatial_offset</span></code> - Set GPS spatial offset</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/distance_spatial_offset</span></code> - Set distance sensor offset</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/optical_flow_spatial_offset</span></code> - Set optical flow offset</p></li>
</ul>
<p><strong>Parameter Management:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/bulk_set_parameters</span></code> - Bulk set PX4 parameters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/bulk_get_parameters</span></code> - Bulk get PX4 parameters</p></li>
</ul>
<p><strong>Telemetry Stream Subscriptions:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/subscribe_rc_value_stream</span></code> - Subscribe to RC stream</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/unsubscribe_rc_value_stream</span></code> - Unsubscribe from RC stream</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/subscribe_pose_value_stream</span></code> - Subscribe to pose stream</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/unsubscribe_pose_value_stream</span></code> - Unsubscribe from pose stream</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/subscribe_ks_status_stream</span></code> - Subscribe to kill switch status</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/unsubscribe_ks_status_stream</span></code> - Unsubscribe from kill switch status</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/subscribe_mfs_a_status_stream</span></code> - Subscribe to MFS A status</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/unsubscribe_mfs_a_status_stream</span></code> - Unsubscribe from MFS A status</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/subscribe_mfs_b_status_stream</span></code> - Subscribe to MFS B status</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/unsubscribe_mfs_b_status_stream</span></code> - Unsubscribe from MFS B status</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/unsubscribeall</span></code> - Unsubscribe from all streams</p></li>
</ul>
<p><strong>Verification Commands:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/verify_pos_yaw_directions</span></code> - Start position/yaw verification</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/verify_pos_yaw_directions_complete</span></code> - Complete position/yaw verification</p></li>
</ul>
<p><strong>Network Configuration:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/connect_to_wifi_and_verify_optitrack</span></code> - Connect WiFi and verify OptiTrack</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/set_static_ip_address</span></code> - Set static IP address</p></li>
</ul>
<p><strong>System Commands:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/reboot_autopilot</span></code> - Reboot the PX4 autopilot</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/format_sd_card</span></code> - Format the Pixhawk SD card</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/get_log_entries</span></code> - Retrieve log entries from the flight controller</p></li>
</ul>
</section>
<section id="published-topics-sent-to-command-web">
<h3>Published Topics (Sent to <code class="docutils literal notranslate"><span class="pre">command/web</span></code>)<a class="headerlink" href="#published-topics-sent-to-command-web" title="Link to this heading"></a></h3>
<p>The petal publishes status updates and async results to <code class="docutils literal notranslate"><span class="pre">command/web</span></code> with the following topics:</p>
<p><strong>System Status:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">/petal-user-journey-coordinator/reboot_px4_status</span></code> - Reboot operation status (success/failure)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/petal-user-journey-coordinator/format_sd_card_status</span></code> - SD card format status (success/failure)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/petal-user-journey-coordinator/get_log_entries_status</span></code> - Log retrieval status (success/failure)</p></li>
</ul>
<p><strong>Bulk Parameter Results:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">/petal-user-journey-coordinator/bulk-parameter-set</span></code> - Bulk parameter set results (success/partial failure/error)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/petal-user-journey-coordinator/bulk-parameter-get</span></code> - Bulk parameter get results (success/partial failure/error)</p></li>
</ul>
<p><strong>Telemetry Streams:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">/petal-user-journey-coordinator/publish_rc_value_stream</span></code> - RC value stream data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/petal-user-journey-coordinator/publish_pose_value_stream</span></code> - Pose value stream data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/petal-user-journey-coordinator/publish_ks_status_stream</span></code> - Kill switch status stream data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/petal-user-journey-coordinator/publish_mfs_a_status_stream</span></code> - MFS A status stream data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/petal-user-journey-coordinator/publish_mfs_b_status_stream</span></code> - MFS B status stream data</p></li>
</ul>
<p><strong>Verification Results:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">/petal-user-journey-coordinator/verify_pos_yaw_directions_results</span></code> - Position/yaw verification results</p></li>
</ul>
<p><strong>Acknowledgments:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/acknowledge</span></code> - Generic command acknowledgment</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petal-user-journey-coordinator/set_static_ip_address_ack</span></code> - Static IP address set acknowledgment</p></li>
</ul>
</section>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../development_contribution/using_proxies.html"><span class="doc">Using Proxies in Petals</span></a> - Proxy usage documentation</p></li>
<li><p><a class="reference internal" href="../changelog.html"><span class="doc">Changelog</span></a> - Version history and changes</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Petal Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="petal_flight_log.html" class="btn btn-neutral float-right" title="Petal Flight Log" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, DroneLeaf.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>